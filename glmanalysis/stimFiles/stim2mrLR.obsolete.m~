% 2007July17
% update mrSession so it knows that the stimfiles are there
function stim2mrLR

subjList = {'DS','JG','LM','RS','SO'};
exptList = {'memory','detect','memDetect','vertical'};
total = length(subjList)*length(exptList);

h = waitbar(0,'adding stimFiles'), waitCount = 0;

% Run through all subjects and expts and days, and set variables
for iExpt = 1:length(exptList)
  for iSubj = 1:length(subjList)
    expt = exptList{iExpt};
    subj = subjList{iSubj};
    waitCount=waitCount+1; waitbar(waitCount/total,h,'Adding stimFiles');
    
    % set the directory
    baseDir = setBaseDir(expt);
    dataDir = [baseDir subj '_' expt];
    cd(dataDir)
    
    mrGlobals
    view = newView;
    
    groupNum = viewGet(view,'groupNum','MotionComp');
    nScans = viewGet(view,'nScans',groupNum);
    for iScan=2:nScans-1 % first and last scans are localizers
      stimFilename = ['stimFiles/stimFile_' num2str(iScan-1) '.mat'];
      view = viewSet(view,'stimFilename',stimFilename,iScan,groupNum);
    end
    
    saveSession;
    
  end % for iSubj
end % for iExpt

close(h);





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% subfunctions

%***************************************
function baseDir = setBaseDir(expt)
switch expt
 case 'memory'
  baseDir = '~/1keystonelink/fMRI_data/Memory/eventRelated/';
 case 'detect'
  baseDir = '~/1keystonelink/fMRI_data/Detection/detectionEvent/';
 case 'memDetect'
  baseDir = '~/1keystonelink/fMRI_data/MemDetect/';
 case 'vertical'
  baseDir = '~/1keystonelink/fMRI_data/Vertical/';
end % switch expt
      
